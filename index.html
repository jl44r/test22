<!doctype html>
<html lang="ar">

<head>
    <meta charset="utf-8">
    <meta http-equiv="pragma" content="no-cache" />
    <meta http-equiv="expires" content="-1" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Internet hotspot - Log in</title>

    <!-- QR Library -->
    <script src="https://unpkg.com/html5-qrcode"></script>

    <!-- Ø±Ø¨Ø· Ù…Ù„Ù Ø§Ù„Ø³ØªØ§ÙŠÙ„ Ø§Ù„Ù…Ø±ÙƒØ²ÙŠ -->
    <link rel="stylesheet" href="css/style.css">
</head>

<body>
    

    
    <div class="page">
        <header class="site-header">
            <!-- Ù‡Ù†Ø§ ÙŠØªÙ… Ø§Ø¸Ø§ÙØ© Ù„ÙˆÙƒÙˆ Ø§Ùˆ Ø­Ø°ÙØ© Ø§Ùˆ Ø§Ø¸Ø§ÙØ© Ø§Ø³Ù… /////////////////// -->
            <!-- <img class="logo" src="img/logo-placeholder.png" alt="Logo" /> -->
            <h1 class="site-title">Internet Hotspot</h1>
            <!-- /////////////////////////////////////////////// -->
        </header>

        <main class="container">
            <section class="login-box" aria-labelledby="login-heading">
                <h2 id="login-heading" class="sr-only">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ù„Ø´Ø¨ÙƒØ©</h2>

                <form name="sendin" action="$(link-login-only)" method="post" class="hidden-post-form"
                    style="display:none">
                    <input type="hidden" name="username" />
                    <input type="hidden" name="password" />
                    <input type="hidden" name="dst" value="$(link-orig)" />
                    <input type="hidden" name="popup" value="true" />
                </form>

                <form name="login" action="$(link-login-only)" method="post" $(if chap-id) onSubmit="return doLogin()"
                    $(endif) class="form">
                    <input type="hidden" name="dst" value="$(link-orig)" />
                    <input type="hidden" name="popup" value="true" />
                    <!-- Ù‡Ù†Ø§ ÙŠØªÙ… Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ø¹Ù„Ø¦ Ø§Ù„ÙƒØªØ§Ø¨Ø© ÙÙŠ ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„Ø¯Ø®ÙˆÙ„ ////////////////////////////////// -->
                    <p class="info">
                        ØµÙˆØ± Ø§Ù„Ø¨Ø§Ø±ÙƒÙˆØ¯ Ø§Ùˆ Ø§Ø¯Ø®Ù„ Ø§Ù„Ø±Ù…Ø² ÙŠØ¯ÙˆÙŠØ§Ù‹
                    </p>
                    <!-- /////////////////////////////////////////////////////// -->
                    <label class="input-wrap" for="username">
                        <img class="ico" src="img/user.svg" alt="" aria-hidden="true" />
                        <input id="username" name="username" type="text" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…"
                            autocomplete="username" />
                    </label>

                    <div class="actions">
                        <button type="button" class="btn btn-qr" onclick="startScan()" aria-controls="reader">
                            ğŸ“· ØµÙˆØ± Ø§Ù„Ø¨Ø§Ø±ÙƒÙˆØ¯
                        </button>

                        <input class="btn btn-submit" type="submit" value="Ø§ØªØµØ§Ù„" />
                    </div>

                    <!-- Ù…Ù†Ø·Ù‚Ø© Ø¹Ø±Ø¶ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ / QR -->
                    <div id="reader" class="qr-reader" aria-hidden="true" style="display:none"></div>
                </form>
            </section>
        </main>

        <footer class="site-footer">
            <p>Â© <span id="year"></span> Ù…Ø²ÙˆØ¯ Ø§Ù„Ø´Ø¨ÙƒØ©</p>
        </footer>
    </div>

    <script>document.getElementById('year').textContent = new Date().getFullYear();</script>
    <script src="/md5.js"></script>
    <script>
        function doLogin() {
            document.sendin.username.value = document.login.username.value;
            document.sendin.password.value =
                hexMD5('$(chap-id)' + document.login.username.value + '$(chap-challenge)');
            document.sendin.submit();
            return false;
        }
    </script>

    <script>
        let html5QrCode;

        function startScan() {
            const reader = document.getElementById("reader");
            reader.style.display = "block";
            reader.setAttribute("aria-hidden", "false");

            html5QrCode = new Html5Qrcode("reader");

            html5QrCode.start(
                { facingMode: "environment" },
                {
                    fps: 10,
                    qrbox: 250
                },
                qrCodeMessage => {
                    document.getElementById("username").value = qrCodeMessage;

                    html5QrCode.stop().then(() => {
                        reader.style.display = "none";
                        reader.setAttribute("aria-hidden", "true");

                        // ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø¨Ø¹Ø¯ Ø§Ù„Ù…Ø³Ø­
                        setTimeout(() => {
                            if (typeof doLogin === "function") {
                                doLogin(); // CHAP
                            } else {
                                document.login.submit(); // NO CHAP
                            }
                        }, 300);
                    }).catch(err => {
                        // ØªØ¬Ø§Ù‡Ù„ Ø£Ùˆ Ø¹Ø±Ø¶ Ø®Ø·Ø£ Ø¨Ø³ÙŠØ· ÙÙŠ Ø§Ù„ console
                        console.warn("Ø®Ø·Ø£ Ø¨Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§:", err);
                    });
                },
                errorMessage => {
                    // ØªØ¬Ø§Ù‡Ù„ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ Ø§Ù„Ø¨Ø³ÙŠØ·Ø© (Ù…Ø«Ù„Ø§Ù‹: Ø¹Ø¯Ù… Ø§Ù„ØªØ¹Ø±Ù Ø¹Ù„Ù‰ QR)
                }
            ).catch(err => {
                console.error("ÙØ´Ù„ ØªØ´ØºÙŠÙ„ ÙƒØ§Ù…ÙŠØ±Ø§ QR:", err);
                // ÙŠÙ…ÙƒÙ† Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù‡Ù†Ø§ Ø¥Ø°Ø§ Ø±ØºØ¨Øª
            });
        }
    </script>

</body>

</html>

